id: fa5c9822-f295-4007-97b8-876dc0ced561
name: Modbus Fingerprinter
description: ---
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
atomic_ordering:
- d80b9cd5-b1d8-482a-a745-71d74f9d0885
- 9360ba0d-46a3-47a1-bbe6-e6c875790500
- 001e21ea-61b5-4b78-b79e-9d5687d819bd
- bc8961a2-7534-4b2a-bbc3-2456f58243be
- 3946b6da-c570-47cd-b63f-c13875297cb4
- 7f43fa44-c2aa-4bb6-ba4b-2c1e58df3b51
abilities:
 d80b9cd5-b1d8-482a-a745-71d74f9d0885:
  name:  Modbus - Read Coils
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_c #{modbus.read_coil.start} #{modbus.read_coil.count}

 9360ba0d-46a3-47a1-bbe6-e6c875790500:
  name:  Modbus - Read Device Information
  tactic:  discovery
  technique_name:  "Remote System Information Discovery"
  technique_id:  T0888
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_device_info --level #{modbus.read_device_info.level}

 001e21ea-61b5-4b78-b79e-9d5687d819bd:
  name:  Modbus - Read Discrete Inputs
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_di #{modbus.read_discrete.start} #{modbus.read_discrete.count}

 bc8961a2-7534-4b2a-bbc3-2456f58243be:
  name:  Modbus - Read Holding Registers
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_hr #{modbus.read_holding.start} #{modbus.read_holding.count}

 3946b6da-c570-47cd-b63f-c13875297cb4:
  name:  Modbus - Read Input Registers
  tactic:  collection
  technique_name:  "Point & Tag Identification"
  technique_id:  T0861
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} read_ir #{modbus.read_input.start} #{modbus.read_input.count}

 7f43fa44-c2aa-4bb6-ba4b-2c1e58df3b51:
  name:  Modbus - Scan Device
  tactic:  collection
  technique_name:  "Automated Collection"
  technique_id:  T0802
  executors:
   - sh:
     platform: linux
     command: |
       ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} scan

   - psh:
     platform: windows
     command: |
       .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} scan

   - sh:
     platform: darwin
     command: |
       ./modbus_cli_darwin #{modbus.server.ip} --port #{modbus.server.port} scan